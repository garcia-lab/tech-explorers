<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé£ Rosy Reel - Fishing Adventure!</title>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Varela+Round&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'Varela Round', sans-serif;
            background: linear-gradient(135deg, #87ceeb, #1e90ff);
            min-height: 100vh;
            padding: 20px;
        }
        
        .game-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* Header */
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-section h1 {
            font-family: 'Comic Neue', cursive;
            font-size: 2.2rem;
            background: linear-gradient(135deg, #ec4899, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .logo-section p {
            font-size: 0.9rem;
            color: #333;
            font-style: italic;
        }
        
        .stats-bar {
            display: flex;
            gap: 30px;
            background: rgba(255,255,255,0.9);
            padding: 15px 25px;
            border-radius: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .stat {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .stat-icon {
            font-size: 1.5rem;
        }
        
        .stat-value {
            font-weight: bold;
            font-size: 1.3rem;
            color: #333;
        }
        
        .nav-links {
            display: flex;
            gap: 10px;
        }
        
        .nav-links a {
            padding: 10px 20px;
            background: rgba(255,255,255,0.9);
            color: #4361ee;
            text-decoration: none;
            border-radius: 25px;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .nav-links a:hover {
            transform: scale(1.05);
            background: white;
        }
        
        /* Main Game Area */
        .game-layout {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
        }
        
        @media (max-width: 900px) {
            .game-layout {
                grid-template-columns: 1fr;
            }
        }
        
        .fishing-area {
            background: white;
            border-radius: 25px;
            padding: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
        }
        
        .pond {
            position: relative;
            width: 100%;
            height: 450px;
            border-radius: 15px;
            overflow: hidden;
            cursor: crosshair;
        }
        
        /* Sky */
        .sky {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 33%;
            background: linear-gradient(180deg, #87ceeb, #b0e0e6);
        }
        
        /* Sun */
        .sun {
            position: absolute;
            top: 15px;
            right: 40px;
            width: 50px;
            height: 50px;
            animation: pulse 4s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        /* Clouds */
        .cloud {
            position: absolute;
            opacity: 0.8;
        }
        
        .cloud-1 { top: 20px; left: 30px; }
        .cloud-2 { top: 40px; right: 100px; opacity: 0.6; }
        .cloud-3 { top: 10px; left: 40%; opacity: 0.7; }
        
        /* Beach */
        .beach {
            position: absolute;
            top: 33%;
            left: 0;
            right: 0;
            height: 17%;
            background: linear-gradient(180deg, #f4d03f, #e9b44c);
        }
        
        /* Water */
        .water {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg, #4fc3f7, #1976d2);
        }
        
        /* Water surface */
        .water-surface {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 3px;
            background: rgba(255,255,255,0.5);
        }
        
        /* Cat in boat */
        .boat-container {
            position: absolute;
            top: 160px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 50;
            transition: left 0.5s ease;
        }
        
        .cat-speech {
            position: absolute;
            top: -80px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 10px 15px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            font-size: 0.85rem;
            font-weight: bold;
            color: #333;
            white-space: nowrap;
            display: none;
            z-index: 100;
        }
        
        .cat-speech::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: white;
        }
        
        .cat-speech.show { display: block; }
        
        /* Fish */
        .fish {
            position: absolute;
            transition: all 0.3s;
            z-index: 30;
        }
        
        .fish.small { transform: scale(0.6); }
        .fish.large { transform: scale(1.2); }
        
        .fish.caught {
            animation: fishStruggle 0.3s infinite;
        }
        
        .fish.reeling {
            transition: all 1s ease-out;
        }
        
        @keyframes fishStruggle {
            0%, 100% { transform: rotate(-10deg) scale(1.3); }
            50% { transform: rotate(10deg) scale(1.3); }
        }
        
        @keyframes fishFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        .fish:not(.caught):not(.reeling) {
            animation: fishFloat 2s ease-in-out infinite;
        }
        
        /* Fishing line */
        .fishing-line {
            position: absolute;
            width: 2px;
            background: #8b4513;
            transform-origin: top;
            z-index: 40;
            display: none;
        }
        
        .fishing-line.cast { display: block; }
        
        .hook {
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 10px;
            height: 10px;
            background: #888;
            border-radius: 50%;
        }
        
        /* Beach friends */
        .beach-friend {
            position: absolute;
            bottom: 0;
            z-index: 20;
        }
        
        .friend-speech {
            position: absolute;
            top: -50px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: bold;
            white-space: nowrap;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .friend-speech::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: white;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .beach-friend svg {
            animation: bounce 1s ease-in-out infinite;
        }
        
        /* Palm tree */
        .palm-tree {
            position: absolute;
            bottom: 0;
            right: 50px;
            z-index: 20;
        }
        
        /* Instructions */
        .instructions {
            position: absolute;
            bottom: 15px;
            left: 15px;
            background: rgba(0,0,0,0.6);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            z-index: 60;
        }
        
        /* Current bait badge */
        .bait-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.9);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
            z-index: 60;
        }
        
        /* Side panels */
        .side-panels {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .panel {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .panel h3 {
            font-family: 'Comic Neue', cursive;
            font-size: 1.3rem;
            color: #3a0ca3;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .fish-count {
            text-align: center;
            padding: 20px;
        }
        
        .fish-count .number {
            font-size: 3rem;
            font-weight: bold;
            color: #ec4899;
        }
        
        .fish-count .label {
            color: #666;
            font-size: 0.9rem;
        }
        
        .sell-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #06d6a0, #00b894);
            color: white;
            border: none;
            border-radius: 15px;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .sell-btn:hover:not(:disabled) {
            transform: scale(1.02);
        }
        
        .sell-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .empty-inventory {
            text-align: center;
            color: #888;
            padding: 30px 10px;
        }
        
        /* Bait shop */
        .bait-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 12px;
            margin-bottom: 10px;
        }
        
        .bait-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .bait-icon {
            width: 30px;
            height: 30px;
            background: #ec4899;
            border-radius: 50%;
        }
        
        .bait-name {
            font-weight: bold;
            color: #333;
        }
        
        .bait-rate {
            font-size: 0.8rem;
            color: #666;
        }
        
        .bait-btn {
            padding: 8px 16px;
            border: 2px solid #4361ee;
            background: white;
            color: #4361ee;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .bait-btn:hover:not(:disabled) {
            background: #4361ee;
            color: white;
        }
        
        .bait-btn:disabled {
            border-color: #ccc;
            color: #ccc;
            cursor: not-allowed;
        }
        
        .bait-btn.active {
            background: #4361ee;
            color: white;
        }
        
        /* Toast notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .toast {
            background: white;
            padding: 15px 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 10px;
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .toast.success { border-left: 4px solid #06d6a0; }
        .toast.error { border-left: 4px solid #ef476f; }
        .toast.info { border-left: 4px solid #4361ee; }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        /* Confetti */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }
        
        .confetti {
            position: absolute;
            animation: confettiFall 3s linear forwards;
        }
        
        @keyframes confettiFall {
            to {
                top: 110%;
                transform: rotate(720deg);
            }
        }
        
        /* Environment selector */
        .environment-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
            align-items: center;
        }
        
        .env-label {
            font-weight: bold;
            color: #333;
            margin-right: 10px;
        }
        
        .env-btn {
            padding: 8px 14px;
            border: 2px solid transparent;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(255,255,255,0.8);
            color: #333;
        }
        
        .env-btn:hover {
            transform: scale(1.05);
        }
        
        .env-btn.active {
            background: linear-gradient(135deg, #4361ee, #7209b7);
            color: white;
            box-shadow: 0 4px 15px rgba(67, 97, 238, 0.4);
        }
        
        /* Tool selector */
        .tool-selector {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 5px;
            background: rgba(255,255,255,0.95);
            padding: 5px;
            border-radius: 25px;
            z-index: 60;
            box-shadow: 0 3px 10px rgba(0,0,0,0.15);
        }
        
        .tool-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            background: #f0f0f0;
            color: #666;
        }
        
        .tool-btn:hover {
            background: #e0e0e0;
        }
        
        .tool-btn.active {
            background: #4361ee;
            color: white;
        }
        
        .tool-btn.spear.active {
            background: #f97316;
        }
        
        /* Improved bait badge */
        .bait-badge {
            position: absolute;
            top: 55px;
            right: 15px;
            background: rgba(255,255,255,0.9);
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            z-index: 60;
        }
        
        /* Scrollable bait shop */
        #bait-shop {
            max-height: 280px;
            overflow-y: auto;
        }
        
        .bait-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 8px;
            border: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .bait-item.active {
            border-color: #4361ee;
            background: rgba(67, 97, 238, 0.1);
        }
        
        .bait-emoji {
            font-size: 1.5rem;
            margin-right: 8px;
        }
        
        /* Keyboard hint */
        .keyboard-hint {
            font-size: 0.75rem;
            color: rgba(255,255,255,0.8);
            margin-top: 5px;
        }
        
        /* Spear animation */
        .spear {
            position: absolute;
            z-index: 45;
            transition: all 0.3s ease-out;
            display: none;
        }
        
        .spear.thrown {
            display: block;
            animation: spearThrow 0.3s ease-out forwards;
        }
        
        @keyframes spearThrow {
            0% { opacity: 0; transform: translateY(-50px) rotate(10deg); }
            100% { opacity: 1; transform: translateY(0) rotate(15deg); }
        }
        
        /* Boat bobbing animation */
        @keyframes boatBob {
            0%, 100% { transform: translateX(-50%) translateY(0) rotate(0deg); }
            25% { transform: translateX(-50%) translateY(-2px) rotate(0.5deg); }
            75% { transform: translateX(-50%) translateY(1px) rotate(-0.3deg); }
        }
        
        .boat-container {
            animation: boatBob 3s ease-in-out infinite;
        }
        
        /* Fish clickable cursor */
        .fish {
            cursor: pointer;
        }
        
        .fish:hover {
            filter: brightness(1.1);
        }
        
        /* Fish container - must span entire pond for fish coordinates to work */
        #fish-container {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 35;
            pointer-events: none;
        }
        
        #fish-container .fish {
            pointer-events: auto;
            cursor: pointer;
        }
        
        /* Shark styles */
        .fish.shark {
            transform: scale(1.4);
            z-index: 35;
        }
        
        .fish.shark:hover {
            filter: brightness(1.2) drop-shadow(0 0 5px rgba(255,255,255,0.5));
        }
        
        @keyframes sharkSwim {
            0%, 100% { transform: scale(1.4) translateY(0); }
            50% { transform: scale(1.4) translateY(-3px); }
        }
        
        .fish.shark:not(.caught):not(.reeling) {
            animation: sharkSwim 1.5s ease-in-out infinite;
        }
        
        /* Speed boat styles */
        .speed-boat-upgrade {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 2px solid #f59e0b;
            position: relative;
            overflow: hidden;
        }
        
        .speed-boat-upgrade.owned {
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            border-color: #10b981;
        }
        
        .speed-boat-upgrade .lightning {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2rem;
            opacity: 0.3;
        }
        
        .speed-boat-upgrade.owned .lightning {
            opacity: 1;
            animation: pulse 1s infinite;
        }
        
        .progress-bar {
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            margin-top: 8px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #fbbf24, #f59e0b);
            border-radius: 3px;
            transition: width 0.3s;
        }
        
        /* Beach fish pile */
        .beach-fish-pile {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 17%;
            top: 33%;
            pointer-events: none;
            z-index: 25;
        }
        
        .pile-fish {
            position: absolute;
            bottom: 5px;
            transition: all 0.3s;
        }
        
        .eating-cat {
            position: absolute;
            bottom: 2px;
            z-index: 26;
        }
        
        @keyframes catEat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-2px); }
        }
        
        .eating-cat svg {
            animation: catEat 0.5s ease-in-out infinite;
        }
        
        /* Spear shop styles */
        .shop-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 8px;
            border: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .shop-item.active {
            border-color: #f97316;
            background: rgba(249, 115, 22, 0.1);
        }
        
        .shop-item.locked {
            opacity: 0.6;
        }
        
        /* Water depth indicator */
        .depth-legend {
            position: absolute;
            bottom: 55px;
            right: 15px;
            background: rgba(0,0,0,0.5);
            padding: 8px 12px;
            border-radius: 10px;
            font-size: 0.7rem;
            color: white;
            z-index: 60;
        }
        
        .depth-legend div {
            display: flex;
            align-items: center;
            gap: 5px;
            margin: 2px 0;
        }
        
        .depth-box {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }
        
        /* Panel tabs */
        .panel-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
        }
        
        .panel-tab {
            flex: 1;
            padding: 8px;
            border: none;
            border-radius: 10px;
            font-size: 0.75rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            background: #e5e7eb;
            color: #666;
        }
        
        .panel-tab.active {
            background: #4361ee;
            color: white;
        }
        
        .panel-tab:hover:not(.active) {
            background: #d1d5db;
        }
        
        .shop-section {
            display: none;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .shop-section.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <header class="game-header">
            <div class="logo-section">
                <svg width="70" height="70" viewBox="0 0 80 80">
                    <ellipse cx="40" cy="55" rx="20" ry="14" fill="#f97316" />
                    <circle cx="40" cy="35" r="18" fill="#f97316" />
                    <path d="M25 25 L20 10 L35 22 Z" fill="#f97316" />
                    <path d="M55 25 L60 10 L45 22 Z" fill="#f97316" />
                    <path d="M25 22 L22 12 L33 20 Z" fill="#fbbf24" />
                    <path d="M55 22 L58 12 L47 20 Z" fill="#fbbf24" />
                    <circle cx="32" cy="30" r="2.5" fill="black" />
                    <circle cx="48" cy="30" r="2.5" fill="black" />
                    <circle cx="33" cy="29" r="0.8" fill="white" />
                    <circle cx="49" cy="29" r="0.8" fill="white" />
                    <path d="M40 38 L37 41 L43 41 Z" fill="#dc2626" />
                    <path d="M40 41 Q35 45 30 42" stroke="black" stroke-width="1.5" fill="none" />
                    <path d="M40 41 Q45 45 50 42" stroke="black" stroke-width="1.5" fill="none" />
                    <line x1="18" y1="32" x2="28" y2="30" stroke="black" stroke-width="1.2" />
                    <line x1="18" y1="38" x2="28" y2="36" stroke="black" stroke-width="1.2" />
                    <line x1="52" y1="30" x2="62" y2="32" stroke="black" stroke-width="1.2" />
                    <line x1="52" y1="36" x2="62" y2="38" stroke="black" stroke-width="1.2" />
                    <line x1="50" y1="60" x2="70" y2="25" stroke="#8b4513" stroke-width="3" />
                    <circle cx="70" cy="25" r="1.5" fill="#8b4513" />
                    <line x1="70" y1="25" x2="75" y2="40" stroke="#333" stroke-width="1" />
                    <ellipse cx="76" cy="46" rx="4" ry="2.5" fill="#ff69b4" />
                </svg>
                <div>
                    <h1>üé£ Rosy Reel</h1>
                    <p>The fishing adventure YOU helped create!</p>
                </div>
            </div>
            
            <div class="stats-bar">
                <div class="stat">
                    <span class="stat-icon">üêü</span>
                    <span class="stat-value" id="fish-count">0</span>
                </div>
                <div class="stat">
                    <span class="stat-icon">üí∞</span>
                    <span class="stat-value" id="money">50</span>
                </div>
            </div>
            
            <div class="nav-links">
                <a href="rosy-reel-code.html"><i class="fas fa-code"></i> See the Code</a>
                <a href="../index.html"><i class="fas fa-home"></i> Home</a>
                <a href="../gallery/index.html"><i class="fas fa-images"></i> Gallery</a>
            </div>
        </header>

        <div class="game-layout">
            <div class="fishing-area">
                <!-- Environment Selector -->
                <div class="environment-selector">
                    <span class="env-label">üåç Environment:</span>
                    <button class="env-btn active" data-env="beach" onclick="setEnvironment('beach')">üèñÔ∏è Beach</button>
                    <button class="env-btn" data-env="lake" onclick="setEnvironment('lake')">üå≤ Lake</button>
                    <button class="env-btn" data-env="arctic" onclick="setEnvironment('arctic')">üßä Arctic</button>
                    <button class="env-btn" data-env="tropical" onclick="setEnvironment('tropical')">üå¥ Tropical</button>
                    <button class="env-btn" data-env="sunset" onclick="setEnvironment('sunset')">üåÖ Sunset</button>
                    <button class="env-btn" data-env="night" onclick="setEnvironment('night')">üåô Night</button>
                </div>
                
                <div class="pond" id="pond" tabindex="0">
                    <!-- Sky -->
                    <div class="sky">
                        <!-- Sun -->
                        <svg class="sun" viewBox="0 0 50 50">
                            <g stroke="#fbbf24" stroke-width="2" stroke-linecap="round">
                                <line x1="25" y1="2" x2="25" y2="8" />
                                <line x1="25" y1="42" x2="25" y2="48" />
                                <line x1="2" y1="25" x2="8" y2="25" />
                                <line x1="42" y1="25" x2="48" y2="25" />
                                <line x1="8" y1="8" x2="12" y2="12" />
                                <line x1="38" y1="38" x2="42" y2="42" />
                                <line x1="8" y1="42" x2="12" y2="38" />
                                <line x1="38" y1="12" x2="42" y2="8" />
                            </g>
                            <circle cx="25" cy="25" r="12" fill="#fde047" stroke="#f59e0b" stroke-width="1" />
                            <circle cx="21" cy="21" r="1.5" fill="#f59e0b" />
                            <circle cx="29" cy="21" r="1.5" fill="#f59e0b" />
                            <path d="M20 28 Q25 32 30 28" stroke="#f59e0b" stroke-width="1.5" fill="none" />
                        </svg>
                        
                        <!-- Clouds -->
                        <svg class="cloud cloud-1" width="60" height="30" viewBox="0 0 60 30">
                            <circle cx="15" cy="15" r="8" fill="white" />
                            <circle cx="25" cy="12" r="10" fill="white" />
                            <circle cx="35" cy="15" r="8" fill="white" />
                            <circle cx="45" cy="18" r="6" fill="white" />
                        </svg>
                        <svg class="cloud cloud-2" width="80" height="40" viewBox="0 0 80 40">
                            <circle cx="20" cy="20" r="12" fill="white" />
                            <circle cx="35" cy="15" r="15" fill="white" />
                            <circle cx="50" cy="20" r="10" fill="white" />
                            <circle cx="65" cy="25" r="8" fill="white" />
                        </svg>
                    </div>
                    
                    <!-- Beach -->
                    <div class="beach">
                        <!-- Palm tree -->
                        <div class="palm-tree">
                            <svg width="70" height="100" viewBox="0 0 70 100">
                                <rect x="29" y="40" width="12" height="60" fill="#8B4513" rx="6" />
                                <path d="M35 40 Q27 25 17 15 Q13 12 17 10 Q23 12 35 30" fill="#228B22" />
                                <path d="M35 40 Q43 25 53 15 Q57 12 53 10 Q47 12 35 30" fill="#228B22" />
                                <path d="M35 40 Q23 30 9 20 Q5 17 9 15 Q15 17 33 30" fill="#32CD32" />
                                <path d="M35 40 Q47 30 61 20 Q65 17 61 15 Q55 17 37 30" fill="#32CD32" />
                                <path d="M35 40 Q35 22 33 5 Q32 0 35 0 Q38 0 37 5 Q35 22 35 40" fill="#228B22" />
                            </svg>
                        </div>
                        
                        <!-- Beach friend 1 - Orange cat -->
                        <div class="beach-friend" style="left: 60px;">
                            <div class="friend-speech" style="color: #f97316;">"Go get 'em!"</div>
                            <svg width="50" height="60" viewBox="0 0 50 60">
                                <ellipse cx="25" cy="45" rx="14" ry="10" fill="#FF8C00" />
                                <circle cx="25" cy="28" r="12" fill="#FF8C00" />
                                <path d="M18 20 L14 8 L26 17 Z" fill="#FF8C00" />
                                <path d="M32 20 L36 8 L24 17 Z" fill="#FF8C00" />
                                <path d="M18 17 L16 10 L24 15 Z" fill="#FFB347" />
                                <path d="M32 17 L34 10 L26 15 Z" fill="#FFB347" />
                                <circle cx="21" cy="25" r="2" fill="black" />
                                <circle cx="29" cy="25" r="2" fill="black" />
                                <path d="M25 30 L23 32 L27 32 Z" fill="#FF1493" />
                                <path d="M25 32 Q21 37 17 34" stroke="black" stroke-width="1" fill="none" />
                                <path d="M25 32 Q29 37 33 34" stroke="black" stroke-width="1" fill="none" />
                            </svg>
                        </div>
                        
                        <!-- Beach friend 2 - Gray cat -->
                        <div class="beach-friend" style="left: 45%; transform: translateX(-50%);">
                            <div class="friend-speech" style="color: #708090;">"Reel 'em in!"</div>
                            <svg width="40" height="50" viewBox="0 0 40 50">
                                <ellipse cx="20" cy="38" rx="10" ry="8" fill="#2F4F4F" />
                                <ellipse cx="20" cy="40" rx="6" ry="5" fill="white" />
                                <circle cx="20" cy="22" r="9" fill="#2F4F4F" />
                                <ellipse cx="20" cy="24" rx="5" ry="6" fill="white" />
                                <path d="M14 14 L10 4 L22 12 Z" fill="#2F4F4F" />
                                <path d="M26 14 L30 4 L18 12 Z" fill="#2F4F4F" />
                                <circle cx="17" cy="20" r="1.5" fill="black" />
                                <circle cx="23" cy="20" r="1.5" fill="black" />
                                <path d="M20 25 L18 27 L22 27 Z" fill="#FF1493" />
                            </svg>
                        </div>
                        
                        <!-- Beach friend 3 - Gray tabby -->
                        <div class="beach-friend" style="right: 120px;">
                            <div class="friend-speech" style="color: #708090;">"You got this!"</div>
                            <svg width="45" height="55" viewBox="0 0 45 55">
                                <ellipse cx="22" cy="42" rx="12" ry="9" fill="#708090" />
                                <circle cx="22" cy="26" r="10" fill="#708090" />
                                <path d="M16 18 L12 6 L24 15 Z" fill="#708090" />
                                <path d="M28 18 L32 6 L20 15 Z" fill="#708090" />
                                <path d="M16 15 L14 8 L22 13 Z" fill="#C0C0C0" />
                                <path d="M28 15 L30 8 L22 13 Z" fill="#C0C0C0" />
                                <circle cx="19" cy="23" r="1.8" fill="black" />
                                <circle cx="25" cy="23" r="1.8" fill="black" />
                                <path d="M22 28 L20 30 L24 30 Z" fill="#FF69B4" />
                            </svg>
                        </div>
                    </div>
                    
                    <!-- Water -->
                    <div class="water"></div>
                    <div class="water-surface"></div>
                    
                    <!-- Cat in boat -->
                    <div class="boat-container" id="boat">
                        <div class="cat-speech" id="cat-speech"></div>
                        
                        <!-- Boat -->
                        <svg width="160" height="100" viewBox="0 0 160 100" style="position: absolute; top: 0; left: 50%; transform: translateX(-50%);">
                            <ellipse cx="80" cy="90" rx="55" ry="8" fill="rgba(0,0,0,0.2)" />
                            <path d="M15 70 Q15 58 28 58 L132 58 Q145 58 145 70 L140 82 Q140 88 132 88 L28 88 Q20 88 20 82 Z" fill="#8B4513" stroke="#654321" stroke-width="2"/>
                            <path d="M28 63 Q28 60 32 60 L128 60 Q132 60 132 63 L132 75 Q132 78 128 78 L32 78 Q28 78 28 75 Z" fill="#D2691E"/>
                            <line x1="80" y1="58" x2="80" y2="15" stroke="#8B4513" stroke-width="4"/>
                            <path d="M82 15 L82 50 L115 35 Q118 32 115 28 L82 15" fill="#FFF8DC" stroke="#DDD" stroke-width="1"/>
                            <polygon points="80,15 85,18 80,21" fill="#ff4444"/>
                        </svg>
                        
                        <!-- Cat -->
                        <svg id="fishing-cat" width="80" height="80" viewBox="0 0 80 80" style="position: relative; top: 15px;">
                            <ellipse cx="40" cy="56" rx="22" ry="15" fill="#f97316" />
                            <circle cx="40" cy="35" r="20" fill="#f97316" />
                            <path d="M25 25 L20 10 L35 22 Z" fill="#f97316" />
                            <path d="M55 25 L60 10 L45 22 Z" fill="#f97316" />
                            <path d="M25 22 L22 12 L33 20 Z" fill="#fbbf24" />
                            <path d="M55 22 L58 12 L47 20 Z" fill="#fbbf24" />
                            <circle cx="32" cy="30" r="2.5" fill="black" />
                            <circle cx="48" cy="30" r="2.5" fill="black" />
                            <circle cx="33" cy="29" r="0.8" fill="white" />
                            <circle cx="49" cy="29" r="0.8" fill="white" />
                            <path d="M40 38 L37 41 L43 41 Z" fill="#dc2626" />
                            <path d="M40 41 Q35 45 30 42" stroke="black" stroke-width="1.2" fill="none" />
                            <path d="M40 41 Q45 45 50 42" stroke="black" stroke-width="1.2" fill="none" />
                            <line x1="18" y1="32" x2="28" y2="30" stroke="black" stroke-width="1.2" />
                            <line x1="18" y1="38" x2="28" y2="36" stroke="black" stroke-width="1.2" />
                            <line x1="52" y1="30" x2="62" y2="32" stroke="black" stroke-width="1.2" />
                            <line x1="52" y1="36" x2="62" y2="38" stroke="black" stroke-width="1.2" />
                            <circle cx="30" cy="65" r="5" fill="#f97316" />
                            <circle cx="50" cy="65" r="5" fill="#f97316" />
                            <line x1="50" y1="60" x2="56" y2="42" stroke="#8b4513" stroke-width="3" stroke-linecap="round" />
                        </svg>
                    </div>
                    
                    <!-- Fishing line -->
                    <div class="fishing-line" id="fishing-line">
                        <div class="hook"></div>
                    </div>
                    
                    <!-- Fish container -->
                    <div id="fish-container"></div>
                    
                    <!-- Tool selector -->
                    <div class="tool-selector">
                        <button class="tool-btn active" data-tool="rod" onclick="setTool('rod')">üé£ Rod</button>
                        <button class="tool-btn spear" data-tool="spear" onclick="setTool('spear')">üî± Spear</button>
                    </div>
                    
                    <!-- Bait badge -->
                    <div class="bait-badge" id="bait-badge">Bait: ü™± Worm</div>
                    
                    <!-- Spear element -->
                    <div class="spear" id="spear">
                        <svg width="30" height="60" viewBox="0 0 30 60">
                            <line x1="15" y1="10" x2="15" y2="55" stroke="#5D4037" stroke-width="3" stroke-linecap="round"/>
                            <path d="M15 10 L10 0 L15 -5 L20 0 Z" fill="#C0C0C0" stroke="#808080" stroke-width="0.5"/>
                        </svg>
                    </div>
                    
                    <!-- Beach fish pile -->
                    <div class="beach-fish-pile" id="beach-fish-pile"></div>
                    
                    <!-- Eating cats container -->
                    <div id="eating-cats-container"></div>
                    
                    <!-- Water depth legend -->
                    <div class="depth-legend">
                        <div style="font-weight: bold; margin-bottom: 3px;">üåä Water Depth</div>
                        <div><span class="depth-box" style="background: #4fc3f7;"></span> Shallow: üêü 5üí∞</div>
                        <div><span class="depth-box" style="background: #1565c0;"></span> Deep: üê† 10üí∞ + ü¶à 25üí∞</div>
                    </div>
                    
                    <!-- Instructions -->
                    <div class="instructions" id="instructions">
                        <div>Click water or fish to cast üé£</div>
                        <div class="keyboard-hint">‚Üê ‚Üí or A/D to move boat</div>
                    </div>
                </div>
            </div>
            
            <div class="side-panels">
                <div class="panel">
                    <h3><i class="fas fa-fish" style="color: #ec4899;"></i> Inventory</h3>
                    <div id="inventory-content">
                        <div class="empty-inventory">
                            No fish caught yet.<br>Cast your line!
                        </div>
                    </div>
                </div>
                
                <!-- Speed Boat Upgrade -->
                <div class="panel speed-boat-upgrade" id="speed-boat-panel">
                    <div class="lightning">‚ö°</div>
                    <h3 style="margin-bottom: 8px;">üö§ Speed Boat</h3>
                    <p id="speed-boat-status" style="font-size: 0.85rem; color: #666;">2x boat speed + lightning design!</p>
                    <button id="speed-boat-btn" class="sell-btn" style="margin-top: 10px; background: linear-gradient(135deg, #f59e0b, #d97706);" onclick="buySpeedBoat()">
                        10,000 ü™ô
                    </button>
                    <div class="progress-bar" id="speed-boat-progress">
                        <div class="progress-fill" id="speed-boat-fill" style="width: 0%;"></div>
                    </div>
                </div>
                
                <div class="panel">
                    <h3><i class="fas fa-store" style="color: #4361ee;"></i> Shop</h3>
                    <div class="panel-tabs">
                        <button class="panel-tab active" onclick="showShopTab('bait')">ü™± Bait</button>
                        <button class="panel-tab" onclick="showShopTab('spear')">üî± Spears</button>
                    </div>
                    <div id="bait-shop" class="shop-section active">
                        <div class="bait-item" data-bait="worm">
                            <div class="bait-info">
                                <span class="bait-emoji">ü™±</span>
                                <div>
                                    <div class="bait-name">Worm</div>
                                    <div class="bait-rate">30% catch</div>
                                </div>
                            </div>
                            <button class="bait-btn active">Using</button>
                        </div>
                        <div class="bait-item" data-bait="minnow">
                            <div class="bait-info">
                                <span class="bait-emoji">üêü</span>
                                <div>
                                    <div class="bait-name">Minnow</div>
                                    <div class="bait-rate">40% catch</div>
                                </div>
                            </div>
                            <button class="bait-btn">10 ü™ô</button>
                        </div>
                        <div class="bait-item" data-bait="cricket">
                            <div class="bait-info">
                                <span class="bait-emoji">ü¶ó</span>
                                <div>
                                    <div class="bait-name">Cricket</div>
                                    <div class="bait-rate">45% catch</div>
                                </div>
                            </div>
                            <button class="bait-btn">15 ü™ô</button>
                        </div>
                        <div class="bait-item" data-bait="shrimp">
                            <div class="bait-info">
                                <span class="bait-emoji">ü¶ê</span>
                                <div>
                                    <div class="bait-name">Shrimp</div>
                                    <div class="bait-rate">50% catch</div>
                                </div>
                            </div>
                            <button class="bait-btn">20 ü™ô</button>
                        </div>
                        <div class="bait-item" data-bait="grub">
                            <div class="bait-info">
                                <span class="bait-emoji">üêõ</span>
                                <div>
                                    <div class="bait-name">Grub</div>
                                    <div class="bait-rate">55% catch</div>
                                </div>
                            </div>
                            <button class="bait-btn">25 ü™ô</button>
                        </div>
                        <div class="bait-item" data-bait="spinner">
                            <div class="bait-info">
                                <span class="bait-emoji">‚ú®</span>
                                <div>
                                    <div class="bait-name">Spinner</div>
                                    <div class="bait-rate">60% catch</div>
                                </div>
                            </div>
                            <button class="bait-btn">35 ü™ô</button>
                        </div>
                        <div class="bait-item" data-bait="fly">
                            <div class="bait-info">
                                <span class="bait-emoji">ü™∞</span>
                                <div>
                                    <div class="bait-name">Fly Lure</div>
                                    <div class="bait-rate">55% catch</div>
                                </div>
                            </div>
                            <button class="bait-btn">40 ü™ô</button>
                        </div>
                        <div class="bait-item" data-bait="jig">
                            <div class="bait-info">
                                <span class="bait-emoji">üé£</span>
                                <div>
                                    <div class="bait-name">Jig</div>
                                    <div class="bait-rate">65% catch</div>
                                </div>
                            </div>
                            <button class="bait-btn">50 ü™ô</button>
                        </div>
                        <div class="bait-item" data-bait="crankbait">
                            <div class="bait-info">
                                <span class="bait-emoji">üê†</span>
                                <div>
                                    <div class="bait-name">Crankbait</div>
                                    <div class="bait-rate">70% catch</div>
                                </div>
                            </div>
                            <button class="bait-btn">60 ü™ô</button>
                        </div>
                        <div class="bait-item" data-bait="spoon">
                            <div class="bait-info">
                                <span class="bait-emoji">ü•Ñ</span>
                                <div>
                                    <div class="bait-name">Spoon Lure</div>
                                    <div class="bait-rate">75% catch</div>
                                </div>
                            </div>
                            <button class="bait-btn">75 ü™ô</button>
                        </div>
                        <div class="bait-item" data-bait="golden">
                            <div class="bait-info">
                                <span class="bait-emoji">üåü</span>
                                <div>
                                    <div class="bait-name">Golden Lure</div>
                                    <div class="bait-rate">85% catch</div>
                                </div>
                            </div>
                            <button class="bait-btn">100 ü™ô</button>
                        </div>
                        <div class="bait-item" data-bait="magic">
                            <div class="bait-info">
                                <span class="bait-emoji">üîÆ</span>
                                <div>
                                    <div class="bait-name">Magic Bait</div>
                                    <div class="bait-rate">95% catch</div>
                                </div>
                            </div>
                            <button class="bait-btn">150 ü™ô</button>
                        </div>
                    </div>
                    
                    <!-- Spear Shop -->
                    <div id="spear-shop" class="shop-section">
                        <p style="font-size: 0.75rem; color: #666; margin-bottom: 8px;">Buy a spear to unlock spear fishing! üî±</p>
                        <div class="shop-item" data-spear="wooden" id="spear-wooden">
                            <div class="bait-info">
                                <span class="bait-emoji">ü™µ</span>
                                <div>
                                    <div class="bait-name">Wooden Spear</div>
                                    <div class="bait-rate">1x accuracy</div>
                                </div>
                            </div>
                            <button class="bait-btn" onclick="buySpear('wooden', 50)">50 ü™ô</button>
                        </div>
                        <div class="shop-item" data-spear="iron" id="spear-iron">
                            <div class="bait-info">
                                <span class="bait-emoji">‚öîÔ∏è</span>
                                <div>
                                    <div class="bait-name">Iron Spear</div>
                                    <div class="bait-rate">1.2x accuracy</div>
                                </div>
                            </div>
                            <button class="bait-btn" onclick="buySpear('iron', 150)">150 ü™ô</button>
                        </div>
                        <div class="shop-item" data-spear="steel" id="spear-steel">
                            <div class="bait-info">
                                <span class="bait-emoji">üó°Ô∏è</span>
                                <div>
                                    <div class="bait-name">Steel Spear</div>
                                    <div class="bait-rate">1.4x accuracy</div>
                                </div>
                            </div>
                            <button class="bait-btn" onclick="buySpear('steel', 300)">300 ü™ô</button>
                        </div>
                        <div class="shop-item" data-spear="golden" id="spear-golden">
                            <div class="bait-info">
                                <span class="bait-emoji">‚ú®</span>
                                <div>
                                    <div class="bait-name">Golden Spear</div>
                                    <div class="bait-rate">1.6x accuracy</div>
                                </div>
                            </div>
                            <button class="bait-btn" onclick="buySpear('golden', 500)">500 ü™ô</button>
                        </div>
                        <div class="shop-item" data-spear="diamond" id="spear-diamond">
                            <div class="bait-info">
                                <span class="bait-emoji">üíé</span>
                                <div>
                                    <div class="bait-name">Diamond Spear</div>
                                    <div class="bait-rate">1.8x accuracy</div>
                                </div>
                            </div>
                            <button class="bait-btn" onclick="buySpear('diamond', 800)">800 ü™ô</button>
                        </div>
                        <div class="shop-item" data-spear="legendary" id="spear-legendary">
                            <div class="bait-info">
                                <span class="bait-emoji">üî±</span>
                                <div>
                                    <div class="bait-name">Poseidon's Trident</div>
                                    <div class="bait-rate">2x accuracy</div>
                                </div>
                            </div>
                            <button class="bait-btn" onclick="buySpear('legendary', 1500)">1500 ü™ô</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="toast-container" id="toast-container"></div>
    
    <script>
        // Build Info
        const BUILD_INFO = {
            commitHash: '6857906',
            buildDate: '2026-01-30'
        };
        
        // Game State
        let fishCount = parseInt(localStorage.getItem('fishing_fishCount')) || 0;
        let money = parseInt(localStorage.getItem('fishing_money')) || 50;
        let currentBait = localStorage.getItem('fishing_bait') || 'worm';
        let currentTool = 'rod';
        let currentEnvironment = 'beach';
        let boatPosition = 50;
        let isLineCast = false;
        let isWaitingToReel = false;
        let lineX = 50;
        let lineY = 80;
        let allFish = [];
        let hasSpeedBoat = localStorage.getItem('fishing_speedBoat') === 'true';
        let currentSpear = localStorage.getItem('fishing_spear') || null;
        let beachFish = JSON.parse(localStorage.getItem('fishing_beachFish') || '[]');
        
        // Spear types
        const spearTypes = {
            wooden: { name: 'ü™µ Wooden Spear', price: 50, accuracy: 1.0 },
            iron: { name: '‚öîÔ∏è Iron Spear', price: 150, accuracy: 1.2 },
            steel: { name: 'üó°Ô∏è Steel Spear', price: 300, accuracy: 1.4 },
            golden: { name: '‚ú® Golden Spear', price: 500, accuracy: 1.6 },
            diamond: { name: 'üíé Diamond Spear', price: 800, accuracy: 1.8 },
            legendary: { name: 'üî± Poseidon\'s Trident', price: 1500, accuracy: 2.0 }
        };
        
        // Shark catch phrases
        const sharkPhrases = [
            "JAWS-ome catch! ü¶à",
            "Shark attack... reversed! üòº",
            "Who's the apex predator now?! üê±",
            "This shark met its match! üé£",
            "Fin-ally got the big one! ü¶à",
            "That's one less shark in the ocean! üò∏"
        ];
        
        const baitTypes = {
            worm: { name: 'ü™± Worm', price: 0, catchRate: 0.3 },
            minnow: { name: 'üêü Minnow', price: 10, catchRate: 0.4 },
            cricket: { name: 'ü¶ó Cricket', price: 15, catchRate: 0.45 },
            shrimp: { name: 'ü¶ê Shrimp', price: 20, catchRate: 0.5 },
            grub: { name: 'üêõ Grub', price: 25, catchRate: 0.55 },
            spinner: { name: '‚ú® Spinner', price: 35, catchRate: 0.6 },
            fly: { name: 'ü™∞ Fly Lure', price: 40, catchRate: 0.55 },
            jig: { name: 'üé£ Jig', price: 50, catchRate: 0.65 },
            crankbait: { name: 'üê† Crankbait', price: 60, catchRate: 0.7 },
            spoon: { name: 'ü•Ñ Spoon Lure', price: 75, catchRate: 0.75 },
            golden: { name: 'üåü Golden Lure', price: 100, catchRate: 0.85 },
            magic: { name: 'üîÆ Magic Bait', price: 150, catchRate: 0.95 }
        };
        
        const environments = {
            beach: {
                sky: 'linear-gradient(180deg, #87ceeb, #b0e0e6)',
                land: 'linear-gradient(180deg, #f4d03f, #e9b44c)',
                water: 'linear-gradient(180deg, #4fc3f7, #1976d2)',
                sunColor: '#fbbf24'
            },
            lake: {
                sky: 'linear-gradient(180deg, #d1fae5, #a7f3d0)',
                land: 'linear-gradient(180deg, #86efac, #16a34a)',
                water: 'linear-gradient(180deg, #67e8f9, #0891b2)',
                sunColor: '#fcd34d'
            },
            arctic: {
                sky: 'linear-gradient(180deg, #f0f9ff, #e0f2fe)',
                land: 'linear-gradient(180deg, #f1f5f9, #cbd5e1)',
                water: 'linear-gradient(180deg, #a5f3fc, #155e75)',
                sunColor: '#fef3c7'
            },
            tropical: {
                sky: 'linear-gradient(180deg, #fdf4ff, #f5d0fe)',
                land: 'linear-gradient(180deg, #fef08a, #facc15)',
                water: 'linear-gradient(180deg, #5eead4, #0f766e)',
                sunColor: '#fb923c'
            },
            sunset: {
                sky: 'linear-gradient(180deg, #fecaca, #fdba74)',
                land: 'linear-gradient(180deg, #fed7aa, #c2410c)',
                water: 'linear-gradient(180deg, #fb923c, #7c2d12)',
                sunColor: '#f97316'
            },
            night: {
                sky: 'linear-gradient(180deg, #1e1b4b, #312e81)',
                land: 'linear-gradient(180deg, #3f3f46, #18181b)',
                water: 'linear-gradient(180deg, #1e3a5f, #0c1929)',
                sunColor: '#fef9c3',
                isMoon: true
            }
        };
        
        const catPhrases = [
            "Purrfect catch! üê±",
            "Meow-nificent! I'm the best fisher in town!",
            "This fish is almost as cute as me... almost! üò∏",
            "Another one bites the... hook! üé£",
            "Fishing level: Cat-tastic! üêæ",
            "Who needs opposable thumbs anyway? üòº",
            "I'm not kitten around - I'm a pro! üéØ",
            "Fin-tastic! That's how we do it! üêü",
            "I'm having a reel-y good time! üé£",
            "Hook, line, and whisker! üò∫",
            "Some-fin special just happened! ‚ú®",
            "I'm the cat's meow at fishing! üò∏",
            "Pawsome catch! High-five? Oh wait... üêæ"
        ];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateDisplay();
            initializeFish();
            startFishMovement();
            updateBaitButtons();
            setupKeyboardControls();
            
            document.getElementById('pond').addEventListener('click', handlePondClick);
            
            // Focus pond for keyboard controls
            document.getElementById('pond').focus();
        });
        
        // Keyboard controls for boat movement
        function setupKeyboardControls() {
            document.addEventListener('keydown', function(e) {
                if (isLineCast && isWaitingToReel) return; // Don't move while fishing
                
                const moveSpeed = hasSpeedBoat ? 10 : 5; // Speed boat = 2x speed!
                if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
                    e.preventDefault();
                    boatPosition = Math.max(15, boatPosition - moveSpeed);
                    updateBoatPosition();
                } else if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
                    e.preventDefault();
                    boatPosition = Math.max(15, Math.min(85, boatPosition + moveSpeed));
                    updateBoatPosition();
                } else if (e.key === 'y' || e.key === 'Y') {
                    // Secret cheat code! Shhh... ü§´
                    money += 100;
                    saveState();
                    updateDisplay();
                    showToast('üí∞ Found treasure! +100 coins!', 'success');
                }
            });
        }
        
        function updateBoatPosition() {
            const boat = document.getElementById('boat');
            if (boat) {
                boat.style.left = boatPosition + '%';
            }
        }
        
        function setEnvironment(env) {
            currentEnvironment = env;
            const envData = environments[env];
            
            document.querySelector('.sky').style.background = envData.sky;
            document.querySelector('.beach').style.background = envData.land;
            document.querySelector('.water').style.background = envData.water;
            
            // Update buttons
            document.querySelectorAll('.env-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.env === env);
            });
            
            showToast(`Environment changed to ${env}!`, 'info');
        }
        
        function setTool(tool) {
            if (tool === 'spear' && !currentSpear) {
                showToast('Buy a spear from the shop first! üî±', 'error');
                return;
            }
            currentTool = tool;
            document.querySelectorAll('.tool-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.tool === tool);
            });
            
            const baitBadge = document.getElementById('bait-badge');
            if (tool === 'spear') {
                baitBadge.textContent = 'üî± Direct strike!';
            } else {
                baitBadge.textContent = `Bait: ${baitTypes[currentBait].name}`;
            }
            
            updateInstructions(tool === 'rod' ? 'Click water or fish to cast üé£' : 'Click on a fish to throw spear! üî±');
        }
        
        function initializeFish() {
            allFish = [
                // Small fish (shallow water: 52-72%)
                { id: 'fish-1', x: 25, y: 58, size: 'small', color: '#87ceeb', speed: 1.5, direction: 45 },
                { id: 'fish-3', x: 40, y: 65, size: 'small', color: '#98fb98', speed: 1.8, direction: 225 },
                { id: 'fish-5', x: 20, y: 62, size: 'small', color: '#f0e68c', speed: 1.3, direction: 90 },
                { id: 'fish-7', x: 50, y: 68, size: 'small', color: '#20b2aa', speed: 1.4, direction: 270 },
                // Large fish (deep water: 72-98%)
                { id: 'fish-2', x: 60, y: 80, size: 'large', color: '#ff69b4', speed: 1, direction: 135 },
                { id: 'fish-4', x: 75, y: 85, size: 'large', color: '#dda0dd', speed: 0.8, direction: 315 },
                { id: 'fish-6', x: 80, y: 90, size: 'large', color: '#ff7f50', speed: 0.6, direction: 180 },
                { id: 'fish-8', x: 35, y: 92, size: 'large', color: '#9370db', speed: 0.7, direction: 0 },
                // SHARKS! (deep water only: 80-98%)
                { id: 'shark-1', x: 45, y: 88, size: 'shark', color: '#64748b', speed: 0.9, direction: 180 },
                { id: 'shark-2', x: 70, y: 94, size: 'shark', color: '#475569', speed: 0.7, direction: 45 }
            ];
            renderFish();
            renderBeachFish();
            updateSpeedBoatUI();
            updateSpearShop();
        }
        
        function renderFish() {
            const container = document.getElementById('fish-container');
            container.innerHTML = allFish.map(fish => {
                const isShark = fish.size === 'shark';
                const width = isShark ? 70 : (fish.size === 'small' ? 32 : 56);
                const height = isShark ? 45 : (fish.size === 'small' ? 24 : 42);
                const fishValue = isShark ? 25 : (fish.size === 'large' ? 10 : 5);
                
                if (isShark) {
                    return `
                        <div class="fish shark" id="${fish.id}" style="left: ${fish.x}%; top: ${fish.y}%;" onclick="handleFishClick(event, '${fish.id}')" title="ü¶à SHARK! Worth ${fishValue} coins!">
                            <svg width="${width}" height="${height}" viewBox="0 0 80 50">
                                <g>
                                    <!-- Shark body -->
                                    <ellipse cx="40" cy="28" rx="28" ry="14" fill="${fish.color}" />
                                    <ellipse cx="40" cy="28" rx="24" ry="11" fill="${fish.color}" fill-opacity="0.9" />
                                    <!-- Belly -->
                                    <ellipse cx="42" cy="32" rx="20" ry="8" fill="#e2e8f0" fill-opacity="0.6" />
                                    <!-- Dorsal fin -->
                                    <path d="M35 14 L40 2 L45 14 Z" fill="${fish.color}" stroke="#1a202c" stroke-width="0.5" />
                                    <!-- Tail fin -->
                                    <path d="M12 28 L2 18 L6 28 L2 38 Z" fill="${fish.color}" fill-opacity="0.95" />
                                    <!-- Pectoral fins -->
                                    <path d="M50 32 L60 42 L55 32 Z" fill="${fish.color}" fill-opacity="0.9" />
                                    <path d="M30 32 L20 42 L25 32 Z" fill="${fish.color}" fill-opacity="0.9" />
                                    <!-- Snout -->
                                    <path d="M68 28 L78 28 L68 24 Z" fill="${fish.color}" />
                                    <!-- Eye -->
                                    <circle cx="60" cy="24" r="5" fill="white" />
                                    <circle cx="61" cy="23" r="3" fill="black" />
                                    <circle cx="62" cy="22" r="1" fill="white" />
                                    <!-- Gills -->
                                    <line x1="52" y1="24" x2="52" y2="32" stroke="#1a202c" stroke-width="1" stroke-linecap="round" />
                                    <line x1="55" y1="24" x2="55" y2="31" stroke="#1a202c" stroke-width="1" stroke-linecap="round" />
                                    <line x1="58" y1="25" x2="58" y2="30" stroke="#1a202c" stroke-width="1" stroke-linecap="round" />
                                    <!-- Teeth -->
                                    <path d="M68 30 L70 32 L72 30 L74 32 L76 30" stroke="white" stroke-width="2" fill="none" stroke-linecap="round" />
                                </g>
                            </svg>
                        </div>
                    `;
                } else {
                    return `
                        <div class="fish ${fish.size}" id="${fish.id}" style="left: ${fish.x}%; top: ${fish.y}%;" onclick="handleFishClick(event, '${fish.id}')" title="${fish.size === 'large' ? 'üê† Large fish' : 'üêü Small fish'} - ${fishValue} coins">
                            <svg width="${width}" height="${height}" viewBox="0 0 48 36">
                                <g>
                                    <ellipse cx="24" cy="18" rx="15" ry="10.5" fill="${fish.color}" />
                                    <ellipse cx="24" cy="18" rx="12" ry="8.25" fill="${fish.color}" fill-opacity="0.8" />
                                    <path d="M9 18 L3 12 L6 18 L3 24 Z" fill="${fish.color}" fill-opacity="0.9" />
                                    <path d="M36 12 L42 9 L45 15 L39 18 Z" fill="${fish.color}" fill-opacity="0.9" />
                                    <path d="M36 24 L42 27 L45 21 L39 18 Z" fill="${fish.color}" fill-opacity="0.9" />
                                    <circle cx="30" cy="13.5" r="3.75" fill="white" />
                                    <circle cx="30.75" cy="12.75" r="2.25" fill="black" />
                                    <circle cx="31.5" cy="12" r="0.75" fill="white" />
                                    <path d="M18 22.5 Q24 24 30 22.5" stroke="${fish.color}" stroke-width="1.5" fill="none" fill-opacity="0.9" />
                                </g>
                            </svg>
                        </div>
                    `;
                }
            }).join('');
        }
        
        function handleFishClick(event, fishId) {
            event.stopPropagation();
            if (isLineCast || isWaitingToReel) return;
            
            const fish = allFish.find(f => f.id === fishId);
            if (!fish) return;
            
            if (currentTool === 'spear') {
                throwSpear(fish.x, fish.y, fish);
            } else {
                // Auto-cast to fish location
                castLine(fish.x, fish.y);
                // Auto-reel after a short delay
                setTimeout(() => {
                    if (isWaitingToReel) reelIn();
                }, 500);
            }
        }
        
        function throwSpear(x, y, targetFish) {
            if (!currentSpear) {
                showToast('Buy a spear from the shop first! üî±', 'error');
                return;
            }
            
            const spear = document.getElementById('spear');
            spear.style.left = x + '%';
            spear.style.top = y + '%';
            spear.classList.add('thrown');
            
            updateInstructions('üî± Spear thrown!');
            
            setTimeout(() => {
                const spearData = spearTypes[currentSpear] || { accuracy: 1.0 };
                const isShark = targetFish.size === 'shark';
                const sizeBonus = isShark ? 0.7 : (targetFish.size === 'large' ? 0.9 : 1.2);
                const catchChance = Math.min(0.95, 0.6 * sizeBonus * spearData.accuracy);
                
                if (Math.random() < catchChance) {
                    catchFishWithSpear(targetFish);
                } else {
                    showToast('Missed! The fish got away...', 'error');
                    spear.classList.remove('thrown');
                    updateInstructions('Click on a fish to throw spear! üî±');
                }
            }, 300);
        }
        
        function catchFishWithSpear(fish) {
            const fishEl = document.getElementById(fish.id);
            const isShark = fish.size === 'shark';
            const fishValue = isShark ? 25 : (fish.size === 'large' ? 10 : 5);
            
            fishEl.classList.add('caught');
            
            // Use shark phrases for sharks
            const phrases = isShark ? sharkPhrases : catPhrases;
            const phrase = phrases[Math.floor(Math.random() * phrases.length)];
            showCatSpeech(phrase);
            
            const fishType = isShark ? 'ü¶à SHARK' : (fish.size === 'large' ? 'big fish' : 'small fish');
            showToast(`Speared a ${fishType}! +${fishValue} coins! üéØüêü`, 'success');
            
            // Add to beach fish pile
            addFishToBeach(fish);
            
            setTimeout(() => {
                money += fishValue;
                updateDisplay();
                saveState();
                createConfetti();
                
                // Reset
                respawnFish(fish);
                fishEl.classList.remove('caught');
                document.getElementById('spear').classList.remove('thrown');
                hideCatSpeech();
                updateInstructions('Click on a fish to throw spear! üî±');
            }, 1500);
        }
        
        function startFishMovement() {
            setInterval(() => {
                allFish = allFish.map(fish => {
                    let newX = fish.x + Math.cos(fish.direction * Math.PI / 180) * fish.speed * 0.5;
                    let newY = fish.y + Math.sin(fish.direction * Math.PI / 180) * fish.speed * 0.5;
                    let newDirection = fish.direction;
                    
                    // Bounce off walls
                    if (newX <= 5 || newX >= 95) {
                        newDirection = 180 - fish.direction;
                        newX = Math.max(5, Math.min(95, newX));
                    }
                    
                    // Depth zones: small fish shallow (52-72%), large/sharks deep (70-98%)
                    const isDeepFish = fish.size === 'large' || fish.size === 'shark';
                    const minY = isDeepFish ? 70 : 52;
                    const maxY = isDeepFish ? 98 : 75;
                    
                    if (newY <= minY || newY >= maxY) {
                        newDirection = -fish.direction;
                        newY = Math.max(minY, Math.min(maxY, newY));
                    }
                    
                    // Random direction changes
                    if (Math.random() < 0.05) {
                        newDirection += (Math.random() - 0.5) * 60;
                    }
                    
                    return { ...fish, x: newX, y: newY, direction: newDirection };
                });
                
                // Update fish positions in DOM
                allFish.forEach(fish => {
                    const el = document.getElementById(fish.id);
                    if (el && !el.classList.contains('caught') && !el.classList.contains('reeling')) {
                        el.style.left = fish.x + '%';
                        el.style.top = fish.y + '%';
                    }
                });
            }, 200);
        }
        
        function handlePondClick(event) {
            const rect = event.currentTarget.getBoundingClientRect();
            const x = ((event.clientX - rect.left) / rect.width) * 100;
            const y = ((event.clientY - rect.top) / rect.height) * 100;
            
            // Can only fish in water (bottom half)
            if (y < 50) {
                showToast('You can only fish in the water!', 'info');
                return;
            }
            
            if (currentTool === 'spear') {
                // Spear requires clicking on a fish directly
                showToast('Click directly on a fish to throw your spear! üî±', 'info');
                return;
            }
            
            if (!isLineCast && !isWaitingToReel) {
                castLine(x, y);
            } else if (isWaitingToReel) {
                reelIn();
            }
        }
        
        function castLine(x, y) {
            isLineCast = true;
            isWaitingToReel = true;
            lineX = x;
            lineY = y;
            
            const boat = document.getElementById('boat');
            boat.style.left = x + '%';
            
            const line = document.getElementById('fishing-line');
            line.classList.add('cast');
            line.style.left = x + '%';
            line.style.top = '215px';
            line.style.height = (y - 48) * 4.5 + 'px';
            
            updateInstructions('Click again to reel in!');
        }
        
        function reelIn() {
            isWaitingToReel = false;
            
            // Check if we caught a fish - sharks have bigger hitbox
            const caughtFish = allFish.find(fish => {
                const distance = Math.abs(fish.x - lineX) + Math.abs(fish.y - lineY);
                const catchRadius = fish.size === 'shark' ? 35 : (fish.size === 'large' ? 30 : 25);
                return distance < catchRadius;
            });
            
            if (caughtFish) {
                const bait = baitTypes[currentBait];
                const isShark = caughtFish.size === 'shark';
                // Sharks are harder to catch, small fish are easier
                const sizeBonus = isShark ? 0.6 : (caughtFish.size === 'large' ? 0.9 : 1.3);
                const catchChance = Math.min(0.95, bait.catchRate * sizeBonus);
                
                if (Math.random() < catchChance) {
                    catchFish(caughtFish);
                    return;
                } else {
                    const fishName = isShark ? 'The shark' : 'The fish';
                    showToast(`${fishName} got away...`, 'error');
                }
            } else {
                showToast('No fish near your hook!', 'info');
            }
            
            resetLine();
        }
        
        function catchFish(fish) {
            const fishEl = document.getElementById(fish.id);
            const isShark = fish.size === 'shark';
            const fishValue = isShark ? 25 : (fish.size === 'large' ? 10 : 5);
            
            // Fighting animation
            fishEl.classList.add('caught');
            fishEl.style.left = lineX + '%';
            fishEl.style.top = lineY + '%';
            updateInstructions(isShark ? 'ü¶à SHARK is fighting hard!' : 'Fish is fighting back!');
            
            setTimeout(() => {
                // Show cat phrase - use shark phrases for sharks
                const phrases = isShark ? sharkPhrases : catPhrases;
                const phrase = phrases[Math.floor(Math.random() * phrases.length)];
                const speech = document.getElementById('cat-speech');
                speech.textContent = phrase;
                speech.classList.add('show');
                
                const fishType = isShark ? 'ü¶à SHARK' : (fish.size === 'large' ? 'big fish' : 'small fish');
                showToast(`Caught a ${fishType}! +${fishValue} coins! üêü`, 'success');
                
                // Reeling animation
                setTimeout(() => {
                    fishEl.classList.remove('caught');
                    fishEl.classList.add('reeling');
                    fishEl.style.top = '8%';
                    updateInstructions('Reeling in your catch!');
                    
                    setTimeout(() => {
                        // Add to beach pile and add coins
                        addFishToBeach(fish);
                        money += fishValue;
                        saveState();
                        updateDisplay();
                        
                        // Respawn fish in appropriate zone
                        const fishIndex = allFish.findIndex(f => f.id === fish.id);
                        const isDeepFish = fish.size === 'large' || fish.size === 'shark';
                        allFish[fishIndex] = {
                            ...fish,
                            x: Math.random() * 80 + 10,
                            y: isDeepFish ? (Math.random() * 25 + 73) : (Math.random() * 18 + 54),
                            direction: Math.random() * 360
                        };
                        
                        fishEl.classList.remove('reeling');
                        fishEl.style.left = allFish[fishIndex].x + '%';
                        fishEl.style.top = allFish[fishIndex].y + '%';
                        
                        speech.classList.remove('show');
                        
                        // Celebration
                        if (fishCount % 5 === 0) {
                            createConfetti();
                        }
                        
                        resetLine();
                    }, 1000);
                }, 1000);
            }, 1500);
        }
        
        function resetLine() {
            isLineCast = false;
            const line = document.getElementById('fishing-line');
            line.classList.remove('cast');
            updateInstructions('Click to cast your line');
        }
        
        function updateInstructions(text) {
            const instructions = document.getElementById('instructions');
            if (typeof text === 'string') {
                const speedHint = hasSpeedBoat ? ' ‚ö°' : '';
                instructions.innerHTML = `<div>${text}</div><div class="keyboard-hint">‚Üê ‚Üí or A/D to move boat${speedHint}</div>`;
            }
        }
        
        function showCatSpeech(phrase) {
            const speech = document.getElementById('cat-speech');
            if (speech) {
                speech.textContent = phrase;
                speech.classList.add('show');
            }
        }
        
        function hideCatSpeech() {
            const speech = document.getElementById('cat-speech');
            if (speech) {
                speech.classList.remove('show');
            }
        }
        
        function respawnFish(fish) {
            // Respawn fish at appropriate depth zone
            const isDeepFish = fish.size === 'large' || fish.size === 'shark';
            fish.x = 10 + Math.random() * 80;
            fish.y = isDeepFish ? (73 + Math.random() * 23) : (54 + Math.random() * 18);
            fish.direction = Math.random() * 360;
            renderFish();
        }
        
        function updateDisplay() {
            document.getElementById('fish-count').textContent = fishCount;
            document.getElementById('money').textContent = money;
            
            const inventory = document.getElementById('inventory-content');
            const beachCount = beachFish.length;
            
            let inventoryHtml = '';
            if (beachCount > 0) {
                inventoryHtml = `
                    <div class="fish-count">
                        <div class="number">${beachCount}</div>
                        <div class="label">üêü Fish on Beach</div>
                    </div>
                    ${beachCount >= 3 ? '<div style="text-align: center; color: #666; font-size: 0.85rem; margin-bottom: 10px;">' + (beachCount >= 8 ? 'üê±üê± Two cats eating!' : 'üê± Cat is eating!') + '</div>' : ''}
                    <button class="sell-btn" onclick="clearBeachFish()" style="background: linear-gradient(135deg, #f97316, #ea580c);">
                        Feed to Cats üòª
                    </button>
                `;
            } else {
                inventoryHtml = '<div class="empty-inventory">No fish on beach yet.<br>Catch some fish!</div>';
            }
            inventory.innerHTML = inventoryHtml;
            
            // Update other UI elements
            updateSpeedBoatUI();
            updateSpearShop();
            updateBaitButtons();
        }
        
        function sellAllFish() {
            if (fishCount > 0) {
                const earnings = fishCount * 5;
                money += earnings;
                fishCount = 0;
                saveState();
                updateDisplay();
                updateBaitButtons();
                showToast(`Sold all fish for ${earnings} coins!`, 'success');
                createConfetti();
            }
        }
        
        function buyBait(baitId, price) {
            if (money >= price) {
                money -= price;
                currentBait = baitId;
                saveState();
                updateDisplay();
                updateBaitButtons();
                showToast(`Purchased ${baitTypes[baitId].name}!`, 'success');
            } else {
                showToast('Not enough coins!', 'error');
            }
        }
        
        function selectBait(baitId) {
            currentBait = baitId;
            localStorage.setItem('fishing_bait', baitId);
            updateBaitButtons();
        }
        
        function updateBaitButtons() {
            document.querySelectorAll('.bait-item').forEach(item => {
                const baitId = item.dataset.bait;
                const btn = item.querySelector('.bait-btn');
                const bait = baitTypes[baitId];
                
                if (!bait) return;
                
                // Update active state
                item.classList.toggle('active', baitId === currentBait);
                
                if (baitId === currentBait) {
                    btn.textContent = '‚úì Using';
                    btn.className = 'bait-btn active';
                    btn.onclick = () => selectBait(baitId);
                } else if (bait.price === 0) {
                    btn.textContent = 'Free';
                    btn.className = 'bait-btn';
                    btn.onclick = () => selectBait(baitId);
                } else {
                    btn.textContent = `${bait.price} ü™ô`;
                    btn.className = 'bait-btn';
                    btn.disabled = money < bait.price;
                    btn.onclick = () => buyBait(baitId, bait.price);
                }
            });
            
            if (currentTool === 'rod') {
                document.getElementById('bait-badge').textContent = `Bait: ${baitTypes[currentBait].name}`;
            }
        }
        
        function saveState() {
            localStorage.setItem('fishing_fishCount', fishCount);
            localStorage.setItem('fishing_money', money);
            localStorage.setItem('fishing_bait', currentBait);
            localStorage.setItem('fishing_speedBoat', hasSpeedBoat);
            localStorage.setItem('fishing_spear', currentSpear || '');
            localStorage.setItem('fishing_beachFish', JSON.stringify(beachFish));
        }
        
        // === SPEED BOAT FUNCTIONS ===
        function buySpeedBoat() {
            if (hasSpeedBoat) return;
            if (money < 10000) {
                showToast('Need 10,000 coins for the Speed Boat! ‚ö°', 'error');
                return;
            }
            
            money -= 10000;
            hasSpeedBoat = true;
            saveState();
            updateDisplay();
            updateSpeedBoatUI();
            showToast('‚ö° SPEED BOAT UNLOCKED! You move 2x faster! üö§', 'success');
            createConfetti();
        }
        
        function updateSpeedBoatUI() {
            const panel = document.getElementById('speed-boat-panel');
            const btn = document.getElementById('speed-boat-btn');
            const status = document.getElementById('speed-boat-status');
            const progress = document.getElementById('speed-boat-progress');
            const fill = document.getElementById('speed-boat-fill');
            
            if (hasSpeedBoat) {
                panel.classList.add('owned');
                btn.style.display = 'none';
                progress.style.display = 'none';
                status.innerHTML = '‚ö° <strong>ACTIVE!</strong> You move 2x faster!';
            } else {
                panel.classList.remove('owned');
                btn.style.display = 'block';
                btn.disabled = money < 10000;
                const progressPercent = Math.min(100, (money / 10000) * 100);
                fill.style.width = progressPercent + '%';
                status.textContent = `Save up! ${money.toLocaleString()} / 10,000 coins`;
            }
        }
        
        // === SPEAR SHOP FUNCTIONS ===
        function showShopTab(tab) {
            document.querySelectorAll('.panel-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.shop-section').forEach(s => s.classList.remove('active'));
            
            document.querySelector(`.panel-tab[onclick*="${tab}"]`).classList.add('active');
            document.getElementById(tab + '-shop').classList.add('active');
        }
        
        function buySpear(spearId, price) {
            if (currentSpear === spearId) {
                showToast('You already have this spear equipped! üî±', 'info');
                return;
            }
            if (money < price) {
                showToast('Not enough coins! üí∞', 'error');
                return;
            }
            
            money -= price;
            currentSpear = spearId;
            saveState();
            updateDisplay();
            updateSpearShop();
            showToast(`Purchased ${spearTypes[spearId].name}! üî±`, 'success');
        }
        
        function updateSpearShop() {
            Object.keys(spearTypes).forEach(spearId => {
                const item = document.getElementById('spear-' + spearId);
                if (!item) return;
                
                const spear = spearTypes[spearId];
                const btn = item.querySelector('.bait-btn');
                
                if (currentSpear === spearId) {
                    item.classList.add('active');
                    btn.textContent = '‚úì Equipped';
                    btn.classList.add('active');
                    btn.disabled = true;
                } else {
                    item.classList.remove('active');
                    btn.textContent = spear.price + ' ü™ô';
                    btn.classList.remove('active');
                    btn.disabled = money < spear.price;
                }
            });
            
            // Update tool selector spear button
            const spearBtn = document.querySelector('.tool-btn.spear');
            if (spearBtn) {
                if (currentSpear) {
                    spearBtn.textContent = 'üî± Spear';
                    spearBtn.style.opacity = '1';
                } else {
                    spearBtn.textContent = 'üîí Spear';
                    spearBtn.style.opacity = '0.6';
                }
            }
        }
        
        // === BEACH FISH PILE FUNCTIONS ===
        function addFishToBeach(fish) {
            const newFish = {
                id: Date.now(),
                size: fish.size,
                color: fish.color,
                x: 10 + Math.random() * 80
            };
            beachFish.push(newFish);
            if (beachFish.length > 20) {
                beachFish = beachFish.slice(-20); // Keep max 20 fish
            }
            saveState();
            renderBeachFish();
        }
        
        function renderBeachFish() {
            const container = document.getElementById('beach-fish-pile');
            const catsContainer = document.getElementById('eating-cats-container');
            if (!container) return;
            
            // Render fish on beach
            container.innerHTML = beachFish.map((fish, i) => {
                const isShark = fish.size === 'shark';
                const size = isShark ? 30 : (fish.size === 'large' ? 25 : 18);
                const rotation = (Math.random() - 0.5) * 40;
                return `
                    <div class="pile-fish" style="left: ${fish.x}%; transform: rotate(${rotation}deg);">
                        <svg width="${size}" height="${size * 0.7}" viewBox="0 0 48 36">
                            ${isShark ? `
                                <ellipse cx="24" cy="18" rx="18" ry="10" fill="${fish.color}" />
                                <path d="M20 8 L24 0 L28 8 Z" fill="${fish.color}" />
                                <path d="M6 18 L0 12 L3 18 L0 24 Z" fill="${fish.color}" />
                                <circle cx="32" cy="14" r="3" fill="white" />
                                <circle cx="33" cy="13" r="1.5" fill="black" />
                            ` : `
                                <ellipse cx="24" cy="18" rx="15" ry="10.5" fill="${fish.color}" />
                                <path d="M9 18 L3 12 L6 18 L3 24 Z" fill="${fish.color}" />
                                <circle cx="30" cy="13.5" r="3" fill="white" />
                                <circle cx="31" cy="12.5" r="1.5" fill="black" />
                            `}
                        </svg>
                    </div>
                `;
            }).join('');
            
            // Render eating cats if we have fish
            if (beachFish.length >= 3) {
                let catsHtml = '';
                // First cat
                catsHtml += `
                    <div class="eating-cat" style="left: 25%;">
                        <svg width="35" height="40" viewBox="0 0 40 50">
                            <ellipse cx="20" cy="38" rx="10" ry="8" fill="#f97316" />
                            <circle cx="20" cy="22" r="10" fill="#f97316" />
                            <path d="M12 14 L8 4 L18 12 Z" fill="#f97316" />
                            <path d="M28 14 L32 4 L22 12 Z" fill="#f97316" />
                            <circle cx="16" cy="20" r="2" fill="black" />
                            <circle cx="24" cy="20" r="2" fill="black" />
                            <path d="M20 25 L18 28 L22 28 Z" fill="#dc2626" />
                            <path d="M18 30 L14 33" stroke="black" stroke-width="1.5" fill="none" />
                        </svg>
                    </div>
                `;
                
                // Second cat if lots of fish
                if (beachFish.length >= 8) {
                    catsHtml += `
                        <div class="eating-cat" style="left: 65%;">
                            <svg width="35" height="40" viewBox="0 0 40 50">
                                <ellipse cx="20" cy="38" rx="10" ry="8" fill="#6b7280" />
                                <circle cx="20" cy="22" r="10" fill="#6b7280" />
                                <path d="M12 14 L8 4 L18 12 Z" fill="#6b7280" />
                                <path d="M28 14 L32 4 L22 12 Z" fill="#6b7280" />
                                <circle cx="16" cy="20" r="2" fill="#22c55e" />
                                <circle cx="24" cy="20" r="2" fill="#22c55e" />
                                <path d="M20 25 L18 28 L22 28 Z" fill="#ec4899" />
                                <path d="M22 30 L26 33" stroke="black" stroke-width="1.5" fill="none" />
                            </svg>
                        </div>
                    `;
                }
                catsContainer.innerHTML = catsHtml;
            } else {
                catsContainer.innerHTML = '';
            }
        }
        
        function clearBeachFish() {
            beachFish = [];
            saveState();
            renderBeachFish();
            showToast('The cats ate all the fish! üòª', 'success');
        }
        
        function showToast(message, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `<span>${message}</span>`;
            container.appendChild(toast);
            
            setTimeout(() => toast.remove(), 3000);
        }
        
        function createConfetti() {
            const container = document.createElement('div');
            container.className = 'confetti-container';
            document.body.appendChild(container);
            
            const colors = ['#f72585', '#4361ee', '#06d6a0', '#ffd166', '#7209b7'];
            const emojis = ['üéâ', '‚≠ê', 'üêü', '‚ú®', 'üéä', 'üê±'];
            
            for (let i = 0; i < 50; i++) {
                const piece = document.createElement('div');
                piece.className = 'confetti';
                const isEmoji = Math.random() > 0.6;
                
                if (isEmoji) {
                    piece.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                    piece.style.fontSize = (Math.random() * 20 + 15) + 'px';
                } else {
                    piece.style.width = (Math.random() * 10 + 5) + 'px';
                    piece.style.height = (Math.random() * 10 + 5) + 'px';
                    piece.style.background = colors[Math.floor(Math.random() * colors.length)];
                    piece.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                }
                
                piece.style.left = Math.random() * 100 + '%';
                piece.style.top = '-20px';
                piece.style.animationDuration = (Math.random() * 2 + 2) + 's';
                
                container.appendChild(piece);
            }
            
            setTimeout(() => container.remove(), 4000);
        }
    </script>
    <footer style="background: #1a1a2e; color: white; padding: 20px; text-align: center; margin-top: 40px;">
        <p style="margin: 0 0 10px 0; opacity: 0.8;">Made with ‚ù§Ô∏è by Tech Explorers | <a href="../index.html" style="color: #06d6a0;">Home</a> | <a href="../activities/all-activities.html" style="color: #06d6a0;">More Activities</a></p>
        <p style="margin: 0; font-size: 0.8rem; opacity: 0.6;">
            <span style="font-family: monospace; background: rgba(255,255,255,0.1); padding: 3px 8px; border-radius: 5px;">üê± Purrfect Catch v<span id="commit-hash"></span></span>
            <span style="margin: 0 10px;">‚Ä¢</span>
            <span>Built <span id="build-date"></span></span>
            <span style="margin: 0 10px;">‚Ä¢</span>
            <a href="" id="github-link" target="_blank" rel="noopener noreferrer" style="color: #06d6a0;">View on GitHub</a>
        </p>
    </footer>
    <script>
        // Populate build info
        document.getElementById('commit-hash').textContent = BUILD_INFO.commitHash;
        document.getElementById('build-date').textContent = BUILD_INFO.buildDate;
        document.getElementById('github-link').href = `https://github.com/garcia-lab/tech-explorers/commit/${BUILD_INFO.commitHash}`;
    </script>
</body>
</html>
